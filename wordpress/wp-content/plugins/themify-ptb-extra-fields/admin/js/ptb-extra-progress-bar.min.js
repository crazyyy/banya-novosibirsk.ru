(function(a){a(document).on("ptb_metabox_create_progress_bar",function(g){var f=g.container.find("."+g.id+"_option_wrapper");var b=g.container.find("#"+g.id+"_options_wrapper");a("#"+g.id+"_"+g.options.orientation).prop("checked",true);f.remove();a.each(g.options.options,function(i,j){var h=f.clone();h.appendTo(b);var e=h.find('input[name^="'+g.id+'_options_"]');e.each(function(){var l=a(this).attr("name").replace(g.id+"_options_","");l=l.replace("[]","");var k=j[l]?j[l]:j.name,m=a.isNumeric(j.id)?j.id:j.id.replace(g.id+"_","");a(this).val(k).attr("id",g.id+"_"+m).data("id",m)});h.find("."+g.id+"_remove").click({option:h},d)});b.sortable({placeholder:"ui-state-highlight"});g.container.find("#"+g.id+"_add_new").click({id:g.id,option:f,wrapper:b},function(j){j.preventDefault();var h=j.data.option.clone();var i=c(j);h.find('input[name^="'+j.data.id+'_options_"]').val("").attr("id",j.data.id+"_"+i).data("id",i);h.find("."+j.data.id+"_remove").click({option:h},d);h.appendTo(j.data.wrapper).hide().show("blind",500);j.data.wrapper.sortable("refresh")});function d(h){h.preventDefault();h.data.option.hide("blind",500,function(){a(this).remove()})}function c(i){var j=a(i.data.option.selector).find('input[name^="'+i.data.id+'_options_"]').map(function(){return a(this).data("id")});j=j.filter(function(e){return e>0});var h=j.length===0?0:Math.max.apply(null,j);return ++h}});a(document).on("ptb_add_metabox_progress_bar",function(b){return{orientation:"horizonal",options:[{name:"Label 1",id:1,selected:true},{name:"Label 2",id:2,selected:false}]}});a(document).on("ptb_metabox_save_progress_bar",function(b){b.options.orientation=a('input[name="'+b.id+'_orientation"]:checked').val();b.options.options={};var c=a("#"+b.id+"_options_wrapper").children("li");c.each(function(e){var d=a(this).find("input[name^="+b.id+"_options_]");b.options.options[e]={};d.each(function(){var f=a(this).attr("name").replace(b.id+"_options_","");f=f.replace("[]","");b.options.options[e][f]=a(this).val();b.options.options[e].id=a(this).attr("id")})})});a(document).ready(function(){a("#ptb_lightbox_container").delegate('div[data-type="progress_bar"] fieldset legend',"click",function(c){c.preventDefault();var b=a(this).next(".ptb_fields_wrapper");if(b.is(":visible")){b.slideUp()}else{b.slideDown()}})})}(jQuery));